---
layout: post
title: Models for Option Pricing
subtitle: Can a model reproduce Black-Scholes when given the same inputs?
bigimg: /img/blue-and-yellow-graph-on-stock-market-monitor-159888.jpg
tags: [finance, options, black-scholes]

---

# Option Pricing

### History
The Black-Scholes-Merton (BSM) option pricing model was first introduced in 1973 by Fischer Black and Myron Scholes in their
seminal paper titled, "The Pricing of Options and Corporate Liabilities" published in the *Journal of Political Economy*. It's
influence on financial markets is hard to understate, and in recognition of their work, Scholes and Merton were awarded the 
Nobel Prize in Economics in 1997. Since it's publication, the BSM pricing model has become THE foundational model for pricing 
the theorectical values of all option types. Specifically, the Black Model is a derivation of the original BSM formula that 
is used to value the price of European options on both forwards and futures. 

Prior to their publication, other research had been done in order to value option prices, but most models revolved around the 
pricing of warrants. Most notably, Sprenkle (1961) was able to derive a formula that looks very similar to what we know today 
as the BSM model, however, there were various other parameters that needed to be estimated (such as *k* which can be thought 
of as the discount factor adjusted for the stock specific risk) in order to derive the options value -- even Sprenkle 
himself could not estimate some of the these variables efficiently and reliably, creating numerous arbitrage opportunities. 
Ultimately, the BSM model won out in terms of it's use case and is used today as the foremost method for pricing financial 
options.


### BSM Model Inputs, Outputs and Methodology
In order for the BSM model to work, Fischer and Scholes needed to make a number of assumptions:
 
  - The underlying asset price follows a geometric Brownian motion process, and the underlying returns are lognormally       
    distributed 
  - The continuously compounded, risk-free rate of return is both constant and known
  - The annualized volatility of the unerlying asset is both constant and known
  - There are no transaction costs (taxes, fees, etc.) and there are no restrictions on short sales and their profits
  - The continuouly compounded yield on the underlying asset is both constant and known
  - The options are European, and can only be exercised at expiration
 
Outside of these assumptions, one of the most important aspects of this model to remember is that it satisfies the "no-
arbitrage" condition that the option price will be the one that, when included in a portfolio, will yield the risk-free rate 
of return. 

The BSM model for pricing calls and puts take in the following inputs:

- *S* = Current Stock Price
- *X* = Strike Price
- *r* = Continuously Compounded Risk-Free Rate 
- *T* = Time to Maturity (based on the percentage of the year left until expiration)
- *v* = Annualized Volatility of the underlying assets returns
- *d1* = 
- *d2* = 
- *N(+ / - d1)* = Cumulative Standard Normal Probability of d1 (positive value for calls and negative for puts)
- *N(+ / - d2)* = Cumulative Standard Normal Probability of d2 (positive value for calls and negative for puts)

and outputs the call (C0) and put (P0) prices below:

- C0
- P0

To simplify the equation inputs, I estimated the risk-free rate (2.14%) by using the 2019, 10-year treasury yields as a 
proxy; I attain this informtion from the US Treasury website. I used the 10-year treasury, and not the Fed Funds rate, because 
of the inability for retail, and some institutional, traders to have access to borrowing and lending at the Fed Funds rate. 
Additionally, I estimated the annualized volatility (28.88%) of the underlying index for 2019 via macrotrends.

The N(d1) and N(d2) terms are probabilities; N(d1) is thought of as the conditional probability of ..... N(d2) is thought of 
as the probability that the option price is expire in-the-money(ITM). 


# Modeling
I chose to fit two different model types: a Linear Regression and a Random Forest Regression. I chose the Linear Regression 
model as a baseline to predict the option traded price, not only because of it's simplicity in terms of understanding the 
outputs, but also because of the dataset I chose. Had I used the option tradde price mean, median, or mode as a baseline, due 
to outliers on both sides of the distribution, the baseline estimate would have been skewed dramatically -- some trade prices 
were as low as .05$ or as a high as 300$, thus, I determined the most efficient baseline would be the Linear Model itself.

I chose the Random Forest Regression model as my second model type for a number of reasons; first, it is similar to the 
binomial option pricing model which uses a decision tree like methodology for pricing based on the probability of the 
underlying assets movements over time. Secondly, the fact that a Random Forest is an ensemble method, which amalgamates the 
outputs of many decision trees to inform the final output, works well when trying to estimate nonlinear relationships between 
variables. Additionally, a Random Forest Regression is able to handle multicollinearity better than most other models, and 
when modeling variables that have interdependencies to other variables it is important to consider that.

My guiding question for this project was: "Can a model predict the actual trade price of an option if given the same inputs
as the BSM model?" The answer lends itself to another question; if a model can accurately predict price, what other features 
and aspects of the model can we reengineer, amend (feature engineering), or tune (parameters, hyperparameters, etc.), to more 
effectively model the true option price?

### Dataset 
The dataset I chose for my project was from the Chicago Board Option Exchange (CBOE); because the CBOE is the official source 
for options and option pricing data, I figured it would be the most accurate source for all the necessary information to 
calculate the BSM model variables.


### Features
I was able to engineer a couple of different 

- Feature Engineering (code)
risk-free rate = annualized 10-year rate for 2019 (source)
annualized volatility for 2019 = 28.88% (source)
time to maturity

Original Features: BSM equation inputs; strike(X); current underlying price(S); risk-free rate(r); time to maturity (T); 
N(d1); N(d2).

Additional Features: trade delta; the underlying ask - strike = distance from the strike; option_bid_ask_spread; 
underlying_bid_ask_spread

All Features: both sets together 

### Results and Scoring

MSE
RMSE
R^2

Visualizations
Linear Equations (coefficients and intercept for linear models)
Random Forest Feature Importances Graphing


### Permutation and Shaply Feature Importance
Feature Importances
Visual
Equations and Output
- Graphing relationship between trade delta and option price


Permutation methodology
why? thesis? output?
- eli5 

Shaply Methodology
why? thesis? output?
- shaply graphing



# Further Analysis Road-Map
This is the beginning of a foray into finding new and improved ways to price options based off of both numeric and non-
numeric, financial and alternative data. By utilizing both financial, and non-financial information, and repurposing ideas 
from other disciplines, I hope to create a dataset informative enough to create a model that can rival one that is 
given only the BSM model inputs. Namely, I hope to recalibrate the existing BSM model, specifically in relation to the use of 
geometric Brownian Motion in defining the Random Walk of stock prices, and create something that is more indicative of the 
dynamic system that is financial markets. I also plan on looking into what option greeks are most informative to option 
pricing theory, and whether they can utilized seperately, or recombined with other factors, to reliably predict the trade 
price of options.


